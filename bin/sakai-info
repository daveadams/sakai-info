#!/usr/bin/env ruby
#
# sakai-info
#   Command line tool for exploring the Sakai database via the
#   sakai-info library
#
# Created 2012-02-15 daveadams@gmail.com
# Last updated 2012-02-19 daveadams@gmail.com
#
# https://github.com/daveadams/sakai-info
#
# This software is public domain.
#

require 'sakai-info'
include SakaiInfo

require 'sakai-info/cli'

if ARGV.length > 0
  case ARGV[0]
  when "help" then
    if ARGV.length > 1
      CLI.help ARGV[1]
    else
      CLI.help
    end
    exit
  when "version" then
    puts VERSION
    exit
  else
    STDERR.puts "ERROR: Command '#{ARGV[0]}' was not recognized."
    STDERR.puts "Run 'sakai-info help' for a list of commands."
    exit 1
  end
else
  STDERR.puts "ERROR: No command was given."
  STDERR.puts "Run 'sakai-info help' for a list of commands."
  exit 1
end

begin
  Configuration.load_config
rescue AlreadyConfiguredException
  # not sure how we would be yet, but if we are, then continue
rescue NoConfigFoundException
  STDERR.puts "No configuration file was found at #{Configuration::DEFAULT_CONFIG_FILE}"
  exit 1
rescue InvalidConfigException => e
  STDERR.puts "Configuration was invalid:"
  STDERR.puts e.message
end

